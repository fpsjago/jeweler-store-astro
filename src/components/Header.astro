---
import { store } from '../data/store';
interface Props { currentPage?: string; }
const { currentPage = '' } = Astro.props;
const links = [
  { href: '/', label: 'Home' },
  { href: '/collections', label: 'Collections' },
  { href: '/about', label: 'About' },
  { href: '/contact', label: 'Contact' },
];
---

<header class="header" id="site-header">
  <div class="header-inner">
    <a href="/" class="logo">{store.name}</a>
    <nav class="nav-desktop">
      {links.map(l => (
        <a href={l.href} class:list={['nav-link', { active: currentPage === l.href }]}>{l.label}</a>
      ))}
    </nav>
    <div class="header-actions">
      <button class="icon-btn" id="theme-toggle" aria-label="Toggle theme">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
      </button>
      <button class="icon-btn" aria-label="Cart">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
        <span class="cart-count">0</span>
      </button>
      <button class="mobile-toggle" id="mobile-toggle" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>
  <nav class="nav-mobile" id="mobile-nav">
    {links.map(l => <a href={l.href} class="mobile-link">{l.label}</a>)}
  </nav>
</header>

<style>
  .header { position: sticky; top: 0; z-index: 100; background: var(--color-bg); border-bottom: 1px solid var(--color-border-light); transition: background var(--transition-slow); }
  .header-inner { display: flex; align-items: center; justify-content: space-between; height: var(--header-height); max-width: var(--max-width); margin: 0 auto; padding: 0 var(--space-md); }
  .logo { font-family: var(--font-heading); font-size: 1.5rem; font-weight: 700; letter-spacing: 0.15em; color: var(--color-accent); }
  .nav-desktop { display: none; gap: var(--space-xl); }
  @media (min-width: 768px) { .nav-desktop { display: flex; } }
  .nav-link { font-size: 0.85rem; font-weight: 500; letter-spacing: 0.08em; text-transform: uppercase; color: var(--color-text-muted); transition: color var(--transition); position: relative; }
  .nav-link::after { content: ''; position: absolute; bottom: -4px; left: 0; width: 0; height: 1px; background: var(--color-accent); transition: width var(--transition); }
  .nav-link:hover, .nav-link.active { color: var(--color-accent); }
  .nav-link:hover::after, .nav-link.active::after { width: 100%; }
  .header-actions { display: flex; align-items: center; gap: var(--space-md); }
  .icon-btn { position: relative; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; color: var(--color-text); transition: background var(--transition), color var(--transition); }
  .icon-btn:hover { background: var(--color-accent-light); color: var(--color-accent); }
  .cart-count { position: absolute; top: 2px; right: 2px; width: 16px; height: 16px; border-radius: 50%; background: var(--color-accent); color: white; font-size: 0.65rem; font-weight: 600; display: flex; align-items: center; justify-content: center; }
  .mobile-toggle { display: flex; flex-direction: column; gap: 5px; width: 24px; }
  @media (min-width: 768px) { .mobile-toggle { display: none; } }
  .mobile-toggle span { display: block; width: 100%; height: 2px; background: var(--color-text); }
  .nav-mobile { display: none; position: fixed; inset: var(--header-height) 0 0 0; background: var(--color-bg); padding: var(--space-xl); z-index: 99; }
  .nav-mobile.open { display: flex; flex-direction: column; gap: var(--space-lg); }
  .mobile-link { font-family: var(--font-heading); font-size: 1.5rem; padding: var(--space-sm) 0; border-bottom: 1px solid var(--color-border-light); }
</style>

<script>
  const toggle = document.getElementById('theme-toggle');
  toggle?.addEventListener('click', () => {
    const current = document.documentElement.getAttribute('data-theme');
    const next = current === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', next);
    localStorage.setItem('theme', next);
  });
  const mt = document.getElementById('mobile-toggle');
  const mn = document.getElementById('mobile-nav');
  mt?.addEventListener('click', () => mn?.classList.toggle('open'));
</script>
